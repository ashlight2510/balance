<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>funnyfunny.cloud ë°¸ëŸ°ìŠ¤ê²Œì„</title>
  <meta name="description" content="ëœë¤ ë°¸ëŸ°ìŠ¤ê²Œì„ 10ë¬¸ì œ. ë§í¬ë¡œ ê³µìœ í•˜ê³  TXTë¡œ ë‚´ë³´ë‚´ê¸°." />
  <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20viewBox%3D%270%200%2064%2064%27%3E%3Crect%20width%3D%2764%27%20height%3D%2764%27%20rx%3D%2714%27%20fill%3D%27%23111%27/%3E%3Ccircle%20cx%3D%2722%27%20cy%3D%2732%27%20r%3D%2710%27%20fill%3D%27%237fd1ff%27/%3E%3Ccircle%20cx%3D%2742%27%20cy%3D%2732%27%20r%3D%2710%27%20fill%3D%27%23ff9f7f%27/%3E%3Crect%20x%3D%2724%27%20y%3D%2730%27%20width%3D%2716%27%20height%3D%274%27%20rx%3D%272%27%20fill%3D%27%23111%27/%3E%3C/svg%3E" type="image/svg+xml" />
  <meta property="og:image" content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Balnce" />
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap");

    :root {
      color-scheme: light;
      --bg: #f6f2ee;
      --bg-2: #f2f6f0;
      --ink: #1a1715;
      --muted: rgba(26, 23, 21, 0.65);
      --line: rgba(26, 23, 21, 0.12);
      --card: rgba(255, 255, 255, 0.7);
      --accent: #ff7a59;
      --accent-2: #59b3ff;
      --accent-3: #ffcc4d;
      --shadow: 0 12px 30px rgba(30, 24, 20, 0.14);
      --ring: 0 0 0 2px rgba(255, 122, 89, 0.35);
    }
    * { box-sizing: border-box; }
    body {
      font-family: "Space Grotesk", "Noto Sans KR", sans-serif;
      margin: 0;
      color: var(--ink);
      background:
        radial-gradient(1400px 500px at 10% -10%, rgba(255, 204, 77, 0.35), transparent 70%),
        radial-gradient(1000px 500px at 90% -10%, rgba(89, 179, 255, 0.28), transparent 70%),
        linear-gradient(140deg, var(--bg), var(--bg-2));
      min-height: 100vh;
    }
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image: radial-gradient(rgba(26, 23, 21, 0.05) 1px, transparent 0);
      background-size: 28px 28px;
      opacity: 0.6;
      pointer-events: none;
    }
    header {
      padding: 26px 18px 18px;
      position: relative;
      border-bottom: 1px solid var(--line);
      background: linear-gradient(120deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.55));
      backdrop-filter: blur(6px);
      animation: floatIn 0.7s ease both;
    }
    h1 { margin: 0 0 8px; font-size: clamp(20px, 4vw, 28px); letter-spacing: -0.02em; }
    .sub { opacity: 0.8; font-size: 13px; line-height: 1.5; color: var(--muted); }
    .headerActions { position: absolute; right: 18px; top: 22px; display: flex; gap: 8px; align-items: center; }
    .headerLink {
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      white-space: nowrap;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 6px 14px rgba(26, 23, 21, 0.08);
    }
    .headerLink:hover { transform: translateY(-1px); }
    main { max-width: 1040px; margin: 16px auto; padding: 18px 18px 60px; position: relative; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin: 14px 0 18px; }
    button, select {
      font-size: 14px;
      padding: 11px 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.85);
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(26, 23, 21, 0.08);
      transition: transform 0.15s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    }
    button:hover, select:hover { transform: translateY(-1px); border-color: rgba(26, 23, 21, 0.2); }
    button:active { transform: translateY(1px); }
    #btnRandom { background: linear-gradient(120deg, rgba(255, 122, 89, 0.18), rgba(255, 204, 77, 0.22)); }
    #btnToday { background: linear-gradient(120deg, rgba(89, 179, 255, 0.2), rgba(255, 255, 255, 0.8)); }
    #btnShareResult { background: linear-gradient(120deg, rgba(255, 204, 77, 0.35), rgba(255, 255, 255, 0.9)); }
    .pill { padding: 7px 12px; border: 1px solid var(--line); border-radius: 999px; font-size: 12px; color: var(--muted); background: rgba(255, 255, 255, 0.7); }
    .row { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; }
    .meta { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; margin: 6px 0 14px; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 14px; }
    @media (min-width: 860px) { .grid { grid-template-columns: 1fr 1fr; } }

    .card {
      border: 1px solid var(--line);
      border-radius: 18px;
      padding: 14px;
      background: var(--card);
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
      animation: fadeUp 0.6s ease both;
    }
    .qtop { display: flex; justify-content: space-between; align-items: baseline; gap: 10px; margin-bottom: 10px; }
    .qnum { font-weight: 700; letter-spacing: -0.02em; }
    .qcat { opacity: 0.7; font-size: 12px; }
    .qtitle { margin: 0 0 12px; font-size: 14px; line-height: 1.55; color: var(--muted); }

    .choices { display: grid; grid-template-columns: 1fr; gap: 10px; }
    @media (min-width: 520px) { .choices { grid-template-columns: 1fr 1fr; } }

    .choiceBtn {
      text-align: left;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(26, 23, 21, 0.16);
      background: rgba(255, 255, 255, 0.85);
      min-height: 60px;
      white-space: normal;
      line-height: 1.4;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .choiceBtn:hover { transform: translateY(-1px); box-shadow: 0 10px 20px rgba(26, 23, 21, 0.12); }
    .choiceBtn strong { display: block; font-size: 12px; margin-bottom: 6px; opacity: 0.75; text-transform: uppercase; letter-spacing: 0.08em; }
    .choiceBtn.selected {
      outline: none;
      border-color: rgba(255, 122, 89, 0.5);
      box-shadow: var(--ring), 0 10px 24px rgba(255, 122, 89, 0.18);
      background: linear-gradient(130deg, rgba(255, 122, 89, 0.15), rgba(255, 204, 77, 0.2));
    }
    .choiceBtn[disabled] { opacity: 0.7; cursor: not-allowed; }
    .status { margin-top: 10px; font-size: 13px; opacity: 0.8; display: flex; gap: 10px; flex-wrap: wrap; color: var(--muted); }
    .bar { height: 10px; border-radius: 999px; background: rgba(26, 23, 21, 0.12); overflow: hidden; width: min(520px, 100%); }
    .bar > div { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent-2), var(--accent)); transition: width 0.2s ease; }
    .summary { margin-top: 18px; }
    textarea {
      width: 100%;
      min-height: 160px;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid var(--line);
      background: rgba(255, 255, 255, 0.85);
      font-size: 13px;
      line-height: 1.5;
      box-shadow: 0 10px 24px rgba(26, 23, 21, 0.08);
    }
    .small { font-size: 12px; color: var(--muted); }
    .warn { color: #c14d36; }
    a { color: inherit; }
    hr { border-top: 1px solid var(--line); }
    @media (max-width: 560px) {
      .headerActions { position: static; margin-top: 10px; justify-content: flex-start; }
      header { padding-bottom: 16px; }
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes floatIn {
      from { opacity: 0; transform: translateY(-6px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
     crossorigin="anonymous"></script>
    <!-- responsive-base -->
    <style>
      /* responsive-base */
      *, *::before, *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
      }
      img,
      video,
      canvas,
      svg {
        max-width: 100%;
        height: auto;
      }
      table {
        width: 100%;
      }
      pre,
      code {
        white-space: pre-wrap;
        word-break: break-word;
      }
    </style>
  <style>
    .adsense-block {
      margin: 16px 0;
      display: flex;
      justify-content: center;
    }
    .adsbygoogle {
      display: block;
      margin: 16px auto;
        text-align: center;
}
    .lang-switch {
      display: inline-flex;
      gap: 4px;
      padding: 2px;
      border-radius: 999px;
      background: rgba(26, 23, 21, 0.05);
      border: 1px solid var(--line);
    }
    .lang-switch button {
      border: none;
      background: transparent;
      color: var(--muted);
      font-size: 12px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 999px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .lang-switch button.active {
      background: var(--accent);
      color: #fff;
    }
    .lang-switch button:hover {
      background: rgba(255, 122, 89, 0.1);
    }
  </style>
</head>
<body><header>
  <div class="headerActions">
    <div class="lang-switch" role="tablist" aria-label="Language switcher">
      <button type="button" data-lang="ko" class="active">KR</button>
      <button type="button" data-lang="en">EN</button>
    </div>
    <a class="headerLink" href="https://funnyfunny.cloud/" target="_blank" rel="noopener noreferrer" data-i18n="viewMore">ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°</a>
  </div>
  <h1 data-i18n="title">funnyfunny ë°¸ëŸ°ìŠ¤ê²Œì„</h1>
  <div class="sub" data-i18n-html="subtitle">
    âœ… <b>ëœë¤ 10ë¬¸ì œ</b> / âœ… <b>ì¹´í…Œê³ ë¦¬ ëœë¤</b> / âœ… <b>ì˜¤ëŠ˜ì˜ 10ë¬¸ì œ(KST)</b><br>
    âœ… <b>ë§í¬ ê³µìœ </b>(URL í•´ì‹œë¡œ ì €ì¥) / âœ… <b>ë‚´ ì„ íƒ TXT</b> ë‚´ë³´ë‚´ê¸° (ì •ì  HTMLë§Œ)
  </div>
</header>

<main>
  <div class="controls">
    <button id="btnRandom" data-i18n="btnRandom">ğŸ² ëœë¤ 10ë¬¸ì œ</button>
    <select id="selCategory" title="ì¹´í…Œê³ ë¦¬ ì„ íƒ" data-i18n-title="selectCategory">
      <option value="" data-i18n="selectCategory">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
    </select>
    <button id="btnCatRandom" data-i18n="btnCatRandom">ğŸ§© ì¹´í…Œê³ ë¦¬ ëœë¤</button>
    <button id="btnToday" data-i18n="btnToday">ğŸ“… ì˜¤ëŠ˜ì˜ 10ë¬¸ì œ</button>
    <button id="btnCopyLink" data-i18n="btnCopyLink">ğŸ”— í˜„ì¬ ë§í¬ ë³µì‚¬</button>
    <button id="btnExportTxt" data-i18n="btnExportTxt">ğŸ§¾ TXTë¡œ ë‚´ë³´ë‚´ê¸°</button>
    <button id="btnReset" data-i18n="btnReset">â™»ï¸ ì´ˆê¸°í™”</button>
  </div>

  <div class="meta">
    <span class="pill" id="pillMode" data-i18n="pillMode">ëª¨ë“œ: -</span>
    <span class="pill" id="pillCat" data-i18n="pillCat">ì¹´í…Œê³ ë¦¬: -</span>
    <span class="pill" id="pillProgress" data-i18n="pillProgress">ì§„í–‰: 0/10</span>
  </div>

  <div class="row">
    <div class="bar" aria-label="ì§„í–‰ë„">
      <div id="progressFill"></div>
    </div>
    <div class="small" id="hintText" data-i18n="hintText">ë²„íŠ¼ì„ ëˆŒëŸ¬ 10ë¬¸ì œë¥¼ ìƒì„±í•˜ì„¸ìš”.</div>
  </div>

  <div style="height:12px"></div>
  <div id="game" class="grid"></div>

  <div class="summary">
    <h2 style="font-size:16px; margin: 18px 0 8px;" data-i18n="resultTitle">ë‚´ ê²°ê³¼(ê³µìœ /ë³µì‚¬ìš©)</h2>
    <textarea id="txtOut" readonly></textarea>
    <div class="controls" style="margin-top: 8px;">
      <button id="btnShareResult" data-i18n="btnShareResult">ğŸ“£ ë‚´ ê²°ê³¼ ê³µìœ í•˜ê¸°</button>
    </div>
    <div class="small" data-i18n-html="resultNote">
      - TXT ë‚´ë³´ë‚´ê¸°ëŠ” íŒŒì¼ ë‹¤ìš´ë¡œë“œë¡œ ì €ì¥ë©ë‹ˆë‹¤.<br>
      - â€œë§í¬ ê³µìœ â€ëŠ” <b>#</b>ì— ë¬¸ì œ ì¡°í•©ì´ ì €ì¥ë˜ì–´ ê°™ì€ ë§í¬ë¡œ ê°™ì€ 10ë¬¸ì œë¥¼ ë‹¤ì‹œ ì—´ ìˆ˜ ìˆì–´ìš”.
    </div>
    <div id="msg" class="small" style="margin-top:8px;"></div>
  </div>

  <hr style="margin: 18px 0; border: none; border-top: 1px solid rgba(127,127,127,.25)">

  <div class="small">
    <b>ë‚˜ì¤‘ì— ë¬¸í•­ ì¶”ê°€</b>: ì•„ë˜ ì½”ë“œì˜ <code>QUESTIONS</code> ë°°ì—´ì— ë¬¸ìì—´ì„ ë” ë¶™ì´ë©´ ë©ë‹ˆë‹¤.<br>
    ë¬¸í•­ í˜•ì‹ì€ <code>"A vs B"</code>ë¡œ ìœ ì§€í•˜ë©´ ìë™ ë¶„í•´ë©ë‹ˆë‹¤.
  </div>
</main>

<script>
/* i18n */
const translations = {
  ko: {
    metaTitle: "funnyfunny.cloud ë°¸ëŸ°ìŠ¤ê²Œì„",
    metaDescription: "ëœë¤ ë°¸ëŸ°ìŠ¤ê²Œì„ 10ë¬¸ì œ. ë§í¬ë¡œ ê³µìœ í•˜ê³  TXTë¡œ ë‚´ë³´ë‚´ê¸°.",
    title: "funnyfunny ë°¸ëŸ°ìŠ¤ê²Œì„",
    subtitle: "âœ… <b>ëœë¤ 10ë¬¸ì œ</b> / âœ… <b>ì¹´í…Œê³ ë¦¬ ëœë¤</b> / âœ… <b>ì˜¤ëŠ˜ì˜ 10ë¬¸ì œ(KST)</b><br>âœ… <b>ë§í¬ ê³µìœ </b>(URL í•´ì‹œë¡œ ì €ì¥) / âœ… <b>ë‚´ ì„ íƒ TXT</b> ë‚´ë³´ë‚´ê¸° (ì •ì  HTMLë§Œ)",
    viewMore: "ë‹¤ë¥¸ ì„œë¹„ìŠ¤ ë³´ê¸°",
    btnRandom: "ğŸ² ëœë¤ 10ë¬¸ì œ",
    selectCategory: "ì¹´í…Œê³ ë¦¬ ì„ íƒ",
    btnCatRandom: "ğŸ§© ì¹´í…Œê³ ë¦¬ ëœë¤",
    btnToday: "ğŸ“… ì˜¤ëŠ˜ì˜ 10ë¬¸ì œ",
    btnCopyLink: "ğŸ”— í˜„ì¬ ë§í¬ ë³µì‚¬",
    btnExportTxt: "ğŸ§¾ TXTë¡œ ë‚´ë³´ë‚´ê¸°",
    btnReset: "â™»ï¸ ì´ˆê¸°í™”",
    pillMode: "ëª¨ë“œ: {mode}",
    pillCat: "ì¹´í…Œê³ ë¦¬: {cat}",
    pillProgress: "ì§„í–‰: {answered}/{total}",
    hintText: "ë²„íŠ¼ì„ ëˆŒëŸ¬ 10ë¬¸ì œë¥¼ ìƒì„±í•˜ì„¸ìš”.",
    hintTextInProgress: "ê° ë¬¸í•­ì—ì„œ A/B ì¤‘ í•˜ë‚˜ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”. (ì„ íƒì€ ë‚´ ë¸Œë¼ìš°ì €ì—ë§Œ ì €ì¥ë¨)",
    hintTextComplete: "ì™„ë£Œ! ì•„ë˜ 'ë‚´ ê²°ê³¼'ë¡œ ê³µìœ í•˜ê±°ë‚˜ TXTë¡œ ì €ì¥í•˜ì„¸ìš”.",
    resultTitle: "ë‚´ ê²°ê³¼(ê³µìœ /ë³µì‚¬ìš©)",
    btnShareResult: "ğŸ“£ ë‚´ ê²°ê³¼ ê³µìœ í•˜ê¸°",
    resultNote: "- TXT ë‚´ë³´ë‚´ê¸°ëŠ” íŒŒì¼ ë‹¤ìš´ë¡œë“œë¡œ ì €ì¥ë©ë‹ˆë‹¤.<br>- â€œë§í¬ ê³µìœ â€ëŠ” <b>#</b>ì— ë¬¸ì œ ì¡°í•©ì´ ì €ì¥ë˜ì–´ ê°™ì€ ë§í¬ë¡œ ê°™ì€ 10ë¬¸ì œë¥¼ ë‹¤ì‹œ ì—´ ìˆ˜ ìˆì–´ìš”.",
    shareTextTitle: "funnyfunny ë°¸ëŸ°ìŠ¤ê²Œì„ (KST {kst})",
    shareTextLink: "ë§í¬:",
    shareTextMyChoice: "ë‚´ ì„ íƒ:",
    shareTextPrompt: "ë„ˆëŠ” ë­ ê³ ë¥¼ë˜? ğŸ˜ˆ",
    shareTextNotSelected: "(ë¯¸ì„ íƒ)",
    statusSelectedA: "ì„ íƒ: A",
    statusSelectedB: "ì„ íƒ: B",
    statusNotSelected: "ì„ íƒ ì•ˆ í•¨",
    categoryNone: "ì¹´í…Œê³ ë¦¬ -",
    questionNumber: "(ë¬¸í•­ #{num})",
    msgGenerateFirst: "ë¨¼ì € 10ë¬¸ì œë¥¼ ìƒì„±í•˜ì„¸ìš”.",
    msgLinkCopied: "ë§í¬ ë³µì‚¬ ì™„ë£Œ!",
    msgTxtSaved: "TXT íŒŒì¼ë¡œ ì €ì¥í–ˆì–´ìš”.",
    msgShareComplete: "ê³µìœ  ì™„ë£Œ!",
    msgResultCopied: "ë‚´ ê²°ê³¼ë¥¼ ë³µì‚¬í–ˆì–´ìš”!",
    msgShareNotSupported: "ê³µìœ ê°€ ì§€ì›ë˜ì§€ ì•Šì•„ìš”. TXTë¡œ ë‚´ë³´ë‚´ê¸°ë¥¼ ì´ìš©í•˜ì„¸ìš”.",
    msgGameLoaded: "ê³µìœ  ë§í¬ë¡œ ê²Œì„ì„ ë¶ˆëŸ¬ì™”ì–´ìš”!",
    msgResetComplete: "ì´ˆê¸°í™” ì™„ë£Œ.",
    shareResultTitle: "funnyfunny ë°¸ëŸ°ìŠ¤ê²Œì„ ê²°ê³¼"
  },
  en: {
    metaTitle: "funnyfunny.cloud Balance Game",
    metaDescription: "Random balance game 10 questions. Share via link and export as TXT.",
    title: "funnyfunny Balance Game",
    subtitle: "âœ… <b>Random 10 questions</b> / âœ… <b>Category random</b> / âœ… <b>Today's 10 questions (KST)</b><br>âœ… <b>Link sharing</b> (saved in URL hash) / âœ… <b>Export my choices as TXT</b> (static HTML only)",
    viewMore: "View Other Services",
    btnRandom: "ğŸ² Random 10 Questions",
    selectCategory: "Select Category",
    btnCatRandom: "ğŸ§© Category Random",
    btnToday: "ğŸ“… Today's 10 Questions",
    btnCopyLink: "ğŸ”— Copy Current Link",
    btnExportTxt: "ğŸ§¾ Export as TXT",
    btnReset: "â™»ï¸ Reset",
    pillMode: "Mode: {mode}",
    pillCat: "Category: {cat}",
    pillProgress: "Progress: {answered}/{total}",
    hintText: "Click a button to generate 10 questions.",
    hintTextInProgress: "Click A or B for each question. (Your choices are saved only in your browser)",
    hintTextComplete: "Complete! Share your results below or save as TXT.",
    resultTitle: "My Results (for sharing/copying)",
    btnShareResult: "ğŸ“£ Share My Results",
    resultNote: "- TXT export will be saved as a file download.<br>- \"Link sharing\" saves the question combination in <b>#</b>, so you can open the same 10 questions again with the same link.",
    shareTextTitle: "funnyfunny Balance Game (KST {kst})",
    shareTextLink: "Link:",
    shareTextMyChoice: "My choice:",
    shareTextPrompt: "What would you choose? ğŸ˜ˆ",
    shareTextNotSelected: "(Not selected)",
    statusSelectedA: "Selected: A",
    statusSelectedB: "Selected: B",
    statusNotSelected: "Not selected",
    categoryNone: "Category -",
    questionNumber: "(Question #{num})",
    msgGenerateFirst: "Please generate 10 questions first.",
    msgLinkCopied: "Link copied!",
    msgTxtSaved: "Saved as TXT file.",
    msgShareComplete: "Share complete!",
    msgResultCopied: "Copied my results!",
    msgShareNotSupported: "Sharing is not supported. Please use TXT export.",
    msgGameLoaded: "Game loaded from shared link!",
    msgResetComplete: "Reset complete.",
    shareResultTitle: "funnyfunny Balance Game Results"
  }
};

const defaultLang = "ko";
const supportedLangs = ["ko", "en"];
let currentLang = defaultLang;

function t(key, vars = {}) {
  const langTable = translations[currentLang] || translations.ko;
  const template = langTable?.[key] ?? translations.ko?.[key] ?? key;
  if (typeof template !== "string") return template;
  return template.replace(/\{(\w+)\}/g, (_, token) =>
    vars[token] !== undefined ? vars[token] : `{${token}}`
  );
}

function applyTranslations() {
  document.title = t("metaTitle");
  const desc = document.querySelector('meta[name="description"]');
  if (desc) desc.setAttribute("content", t("metaDescription"));
  document.documentElement.lang = currentLang;
  document.querySelectorAll("[data-i18n]").forEach((el) => {
    el.textContent = t(el.dataset.i18n);
  });
  document.querySelectorAll("[data-i18n-html]").forEach((el) => {
    el.innerHTML = t(el.dataset.i18nHtml);
  });
  document.querySelectorAll("[data-i18n-title]").forEach((el) => {
    el.setAttribute("title", t(el.dataset.i18nTitle));
  });
  // Update category select
  if (selCategory) {
    Array.from(selCategory.options).forEach((opt, idx) => {
      if (idx === 0) return; // Skip first option (placeholder)
      const cat = CATEGORIES.find(c => c.key === opt.value);
      if (cat) {
        opt.textContent = currentLang === "en" ? cat.nameEn : cat.nameKo;
      }
    });
  }
  // Re-render game if active
  if (current) {
    renderGame();
    updateMeta(loadAnswers(current.id));
  }
}

function setLang(lang, options = {}) {
  const nextLang = translations[lang] ? lang : defaultLang;
  currentLang = nextLang;
  document.documentElement.lang = nextLang;
  localStorage.setItem("preferredLang", nextLang);
  document.querySelectorAll(".lang-switch button").forEach((button) => {
    button.classList.toggle("active", button.dataset.lang === nextLang);
  });
  applyTranslations();
  if (typeof updateMeta === "function" && current) updateMeta(loadAnswers(current.id));
  if (options.updateUrl) {
    const url = new URL(window.location.href);
    url.searchParams.set("lang", nextLang);
    window.history.replaceState({}, "", url);
  }
}

function detectLang() {
  const params = new URLSearchParams(window.location.search);
  const paramLang = params.get("lang");
  if (supportedLangs.includes(paramLang)) return paramLang;
  const stored = localStorage.getItem("preferredLang");
  if (supportedLangs.includes(stored)) return stored;
  const browserLang =
    navigator.languages && navigator.languages.length
      ? navigator.languages[0]
      : navigator.language;
  if (browserLang && browserLang.toLowerCase().startsWith("ko")) {
    return "ko";
  }
  return defaultLang;
}

/**
 * =========================================================
 *  200ê°œ ë°¸ëŸ°ìŠ¤ ë¬¸í•­ (ì‚¬ìš©ì ìš”ì²­: ë‚´ê°€ ë§Œë“  200ê°œë¡œ ì‹œì‘)
 *  ì¹´í…Œê³ ë¦¬ëŠ” "êµ¬ê°„"ìœ¼ë¡œ ê°„ë‹¨íˆ íƒœê¹…:
 *   1-20 ìŒì‹
 *   21-40 ìƒí™œ
 *   41-60 ì§ì¥/í•™êµ
 *   61-80 ì¹œêµ¬/ì—°ì• 
 *   81-100 ì´ˆëŠ¥ë ¥/íŒíƒ€ì§€
 *   101-120 ì—¬í–‰
 *   121-140 ì·¨ë¯¸/ì½˜í…ì¸ 
 *   141-160 í…Œí¬/í°/SNS
 *   161-180 ë¼ì´í”„/ìš´ë™/ì™¸ëª¨
 *   181-200 ê¸°íƒ€/ì„±ê²©/ì¸ìƒ
 * =========================================================
 */
const QUESTIONS = [
  "í‰ìƒ ë¬¼ë§Œ ë§ˆì‹œê¸° vs í‰ìƒ íƒ„ì‚°ë§Œ ë§ˆì‹œê¸°",
  "í‰ìƒ ë¼ë©´ ê¸ˆì§€ vs í‰ìƒ ì¹˜í‚¨ ê¸ˆì§€",
  "í‰ìƒ ì»¤í”¼ ê¸ˆì§€ vs í‰ìƒ ì´ˆì½œë¦¿ ê¸ˆì§€",
  "í‰ìƒ ë§¤ìš´ë§›ë§Œ ê°€ëŠ¥ vs í‰ìƒ ìˆœí•œë§›ë§Œ ê°€ëŠ¥",
  "í‰ìƒ ë°¥ë§Œ ë¨¹ê¸° vs í‰ìƒ ë¹µë§Œ ë¨¹ê¸°",
  "í‰ìƒ ë–¡ë³¶ì´ ê¸ˆì§€ vs í‰ìƒ ì•„ì´ìŠ¤í¬ë¦¼ ê¸ˆì§€",
  "ì‚¼ê²¹ì‚´ ë¬´í•œ vs ì´ˆë°¥ ë¬´í•œ",
  "í”¼ì í† í•‘ ì „ë¶€ ë¹¼ê¸° vs í† í•‘ 5ê°œ ì´ìƒë§Œ ê°€ëŠ¥",
  "í‰ìƒ ì•¼ì‹ ê°€ëŠ¥(ì‚´ ì•ˆ ì°œ) vs í‰ìƒ ì•¼ì‹ ê¸ˆì§€(ì‚´ ì•ˆ ì°œ)",
  "ê¹€ì¹˜ ì—†ì´ ì‚´ê¸° vs êµ­ë¬¼ ì—†ì´ ì‚´ê¸°",
  "ì§ ë§› 2ë°°ë¡œ ëŠë¼ê¸° vs ë‹¨ë§› 2ë°°ë¡œ ëŠë¼ê¸°",
  "í‰ìƒ ì½œë¼ë§Œ ê°€ëŠ¥ vs í‰ìƒ ì‚¬ì´ë‹¤ë§Œ ê°€ëŠ¥",
  "ì•„ì´ìŠ¤í¬ë¦¼ ê²¨ìš¸ì—ë§Œ ê°€ëŠ¥ vs ì—¬ë¦„ì—ë§Œ ê°€ëŠ¥",
  "ì¹˜í‚¨ì€ í•­ìƒ í½í½ì‚´ vs í•­ìƒ ë‹­ë‹¤ë¦¬ë§Œ(ë‹¤ë¥¸ ë¶€ìœ„ ì—†ìŒ)",
  "ë¼ë©´ì€ êµ­ë¬¼ë§Œ vs ë©´ë§Œ",
  "í–„ë²„ê±°ëŠ” íŒ¨í‹° 2ì¥ vs ì¹˜ì¦ˆ 2ì¥(íŒ¨í‹° 1ì¥)",
  "ë–¡ë³¶ì´ëŠ” ë–¡ë§Œ vs ì–´ë¬µë§Œ",
  "í‰ìƒ ê³¼ì¼ ê¸ˆì§€ vs í‰ìƒ ì±„ì†Œ ê¸ˆì§€",
  "ë§¤ì¼ ê°™ì€ ë©”ë‰´ vs ë§¤ì¼ ëœë¤ ë©”ë‰´(ì„ íƒ ë¶ˆê°€)",
  "ì™¸ì‹ë§Œ ê°€ëŠ¥ vs ì§‘ë°¥ë§Œ ê°€ëŠ¥",

  "ì•ŒëŒ ì—†ì´ ê¸°ìƒ vs í•­ìƒ ì•ŒëŒ 10ê°œ í•„ìš”",
  "í•˜ë£¨ 4ì‹œê°„ë§Œ ìê¸° vs í•˜ë£¨ 12ì‹œê°„ì”© ìê¸°",
  "ìƒ¤ì›Œ 5ë¶„ ì œí•œ vs ìƒ¤ì›Œ ë¬¼ ì˜¨ë„ ëœë¤",
  "í‰ìƒ íœ´ëŒ€í° ë°°í„°ë¦¬ 20%ì—ì„œ ë©ˆì¶¤ vs 80%ì—ì„œ ë©ˆì¶¤",
  "í‰ìƒ ì´ì–´í° í•œìª½ë§Œ ê°€ëŠ¥ vs í•­ìƒ ìŠ¤í”¼ì»¤ë¡œë§Œ ë“£ê¸°",
  "ì´ë¶ˆ í•­ìƒ ì°¨ê°€ì›€ vs í•­ìƒ ë”°ëœ»í•¨",
  "ë¹„ ì˜¤ëŠ” ë‚ ë§Œ ì™¸ì¶œ ê°€ëŠ¥ vs ë§‘ì€ ë‚ ë§Œ ì™¸ì¶œ ê°€ëŠ¥",
  "í‰ìƒ ì‹ ë°œ ëˆ ìì£¼ í’€ë¦¼ vs ì§€í¼ ìì£¼ ê±¸ë¦¼",
  "í•˜ë£¨ 10ë¶„ ìˆœê°„ì´ë™ ê°€ëŠ¥ vs í•˜ë£¨ 1ì‹œê°„ íˆ¬ëª…ì¸ê°„ ê°€ëŠ¥",
  "í•­ìƒ 5ë¶„ ëŠ¦ê²Œ ë„ì°© vs í•­ìƒ 30ë¶„ ì¼ì° ë„ì°©",
  "ì§‘ì•ˆ ì˜¨ë„ í•­ìƒ 18ë„ vs í•­ìƒ 28ë„",
  "ì™€ì´íŒŒì´ë§Œ ê°€ëŠ¥ vs ë°ì´í„°ë§Œ ê°€ëŠ¥",
  "í‰ìƒ í° ì¼€ì´ìŠ¤ ì—†ì´ vs í‰ìƒ ë‘êº¼ìš´ ë²”í¼ë§Œ",
  "ë¹„ë°€ë²ˆí˜¸ ë§¤ì¼ ë°”ë€œ vs ë¹„ë°€ë²ˆí˜¸ ì ˆëŒ€ ëª» ë°”ê¿ˆ",
  "í‰ìƒ ì†ëª©ì‹œê³„ë§Œ ì‚¬ìš© vs í‰ìƒ ë²½ì‹œê³„ë§Œ ì˜ì¡´",
  "í•˜ë£¨ì— ë”± í•œ ë²ˆë§Œ ì›ƒê¸° vs í•˜ë£¨ì— ë”± í•œ ë²ˆë§Œ í™”ë‚´ê¸°",
  "í‰ìƒ ëª¨ê¸° í•œ ë§ˆë¦¬ ë”°ë¼ë‹¤ë‹˜ vs íŒŒë¦¬ í•œ ë§ˆë¦¬ ë”°ë¼ë‹¤ë‹˜",
  "í‰ìƒ íƒì‹œ ê¸ˆì§€ vs í‰ìƒ ì§€í•˜ì²  ê¸ˆì§€",
  "ì—˜ë¦¬ë² ì´í„°ë§Œ ê°€ëŠ¥ vs ê³„ë‹¨ë§Œ ê°€ëŠ¥",
  "ì–‘ì¹˜ 30ì´ˆë§Œ ê°€ëŠ¥ vs ì„¸ìˆ˜ 30ì´ˆë§Œ ê°€ëŠ¥",

  "ì§ì¥/í•™êµì—ì„œ ë§¤ì¼ ë°œí‘œ vs ë§¤ì¼ ë‹¨ì²´ì‚¬ì§„",
  "ìƒì‚¬/êµìˆ˜ë‹˜ì´ ë†ë‹´ ê°•ìš” vs ì¹­ì°¬ ê°•ìš”",
  "ë§¤ì¼ íšŒì˜ 2ì‹œê°„ vs ë§¤ì¼ ë³´ê³ ì„œ 2ì‹œê°„",
  "ì¶œê·¼/ë“±êµ 30ë¶„ ì¶”ê°€ vs í‡´ê·¼/í•˜êµ 30ë¶„ ì¶”ê°€",
  "íŒ€í”Œë§Œ ìˆëŠ” í•™ê¸° vs ì‹œí—˜ë§Œ ìˆëŠ” í•™ê¸°",
  "ë§¤ì¼ ì•¼ê·¼ 1ì‹œê°„ vs ì£¼ë§ ì¶œê·¼ ì›” 2íšŒ",
  "íšŒì‚¬ ì ì‹¬ ë©”ë‰´ í•­ìƒ ëœë¤ vs í•­ìƒ ê³ ì •",
  "ë©”ì¼/ë©”ì‹ ì € ë‹µì¥ ì¦‰ì‹œ ê°•ì œ vs í•˜ë£¨ 2ë²ˆë§Œ í™•ì¸ ê°€ëŠ¥",
  "íšŒì‹ ì›” 4íšŒ vs ì›Œí¬ìˆ ë¶„ê¸° 1íšŒ",
  "ë°œí‘œëŠ” ì™„ë²½í•˜ì§€ë§Œ ì§ˆë¬¸ì— ì•½í•¨ vs ë°œí‘œëŠ” ì•½í•˜ì§€ë§Œ ì§ˆë¬¸ì— ê°•í•¨",
  "ì›”ê¸‰ 10%â†‘ ëŒ€ì‹  íœ´ê°€ 0ì¼ vs ì›”ê¸‰ 10%â†“ ëŒ€ì‹  íœ´ê°€ 2ë°°",
  "ì¶œê·¼ê¸¸ ì§€ì˜¥ vs í‡´ê·¼ê¸¸ ì§€ì˜¥",
  "í˜¼ì ì¼í•˜ê¸° vs ê³„ì† í˜‘ì—…í•˜ê¸°",
  "ì¹­ì°¬ì€ ê³µê°œì ìœ¼ë¡œë§Œ vs í”¼ë“œë°±ì€ ê³µê°œì ìœ¼ë¡œë§Œ",
  "íŒ€ì›ì´ ë„ˆë¬´ ëŠë¦¼ vs íŒ€ì›ì´ ë„ˆë¬´ ë¹ ë¦„(ë‚˜ë¥¼ ëŒê³  ê°)",
  "íšŒì˜ ë•Œë§Œ ë§ ì˜í•¨ vs ì‘ì—… ë•Œë§Œ ì˜í•¨",
  "ìƒì‚¬ê°€ ë””í…Œì¼ ì§‘ì°© vs ìƒì‚¬ê°€ ë°©í–¥ë§Œ ë˜ì§",
  "ë§¤ì¼ ì•„ì¹¨ ìŠ¤ëª°í† í¬ 10ë¶„ vs ë§¤ì¼ í‡´ê·¼ ì „ íšŒê³  10ë¶„",
  "ì˜¤í”¼ìŠ¤ BGM ê°•ì œ vs ì™„ì „ ë¬´ìŒ ê°•ì œ",
  "ìë¦¬ ê³ ì • ì˜¤í”ˆì˜¤í”¼ìŠ¤ vs ìë¦¬ ë§¤ì¼ ëœë¤",

  "ì¹œêµ¬ë‘ í•­ìƒ ì·¨í–¥ ê²¹ì¹¨ vs í•­ìƒ ë°˜ëŒ€ ì·¨í–¥",
  "ë‹µì¥ ë¹ ë¥¸ ì¹œêµ¬ë§Œ vs ì•½ì† ì˜ ì¡ëŠ” ì¹œêµ¬ë§Œ",
  "ì½ì”¹ì€ ì—†ìŒ(ëŒ€ì‹  ë‹¨ë‹µ) vs ë‹¨ë‹µ ì—†ìŒ(ëŒ€ì‹  ì½ì”¹)",
  "ë‚´ ì–˜ê¸°ë§Œ í•˜ëŠ” ì¹œêµ¬ vs ë‚¨ ì–˜ê¸°ë§Œ í•˜ëŠ” ì¹œêµ¬",
  "ìƒì¼íŒŒí‹° í¬ê²Œ vs ìƒì¼ ì™„ì „ ì¡°ìš©íˆ",
  "ì„ ë¬¼ ì„¼ìŠ¤ ì—†ìŒ vs ì¶•í•˜ ë©˜íŠ¸ ì„¼ìŠ¤ ì—†ìŒ",
  "â€œì‚¬ì§„ ë§ì´ ì°ìâ€ ì¹œêµ¬ vs â€œì‚¬ì§„ 0ì¥â€ ì¹œêµ¬",
  "ë§Œë‚  ë•Œë§ˆë‹¤ ê³„íš ë¹¡ì„¸ê²Œ vs ë§Œë‚  ë•Œë§ˆë‹¤ ì¦‰í¥",
  "ë‹¨í†¡ë°© í™œë°œ vs ë‹¨í†¡ë°© ì¡°ìš©(í•„ìš”í•  ë•Œë§Œ)",
  "ì¹œêµ¬ê°€ ì•½ì† 10ë¶„ ëŠ¦ìŒ vs ë‚´ê°€ 10ë¶„ ëŠ¦ìŒ",
  "ì¹œí•´ì§€ë©´ ë“œë¦½ ì‹¬í•¨ vs ì¹œí•´ì§€ë©´ ë¬´ëšëš",
  "ë§¤ì¼ ì—°ë½í•˜ëŠ” ê´€ê³„ vs ì¼ì£¼ì¼ì— í•œ ë²ˆ ê¹Šê²Œ ëŒ€í™”",
  "ì·¨ë¯¸ ê°™ì´ í•˜ëŠ” ì¹œêµ¬ vs ê³ ë¯¼ ë“¤ì–´ì£¼ëŠ” ì¹œêµ¬",
  "ë§ë¡œ ì• ì •í‘œí˜„ vs í–‰ë™ìœ¼ë¡œ ì• ì •í‘œí˜„",
  "ë°ì´íŠ¸ëŠ” í•­ìƒ ì•¼ì™¸ vs í•­ìƒ ì‹¤ë‚´",
  "ê³ ë°±ì€ ë¨¼ì € í•˜ê¸° vs ê³ ë°±ì€ ë°›ê¸°",
  "ì—°ì•  ì¤‘ SNS ê³µê°œ vs ë¹„ê³µê°œ",
  "ê¸°ë…ì¼ ì±™ê¸°ê¸° ë¹¡ì„¸ê²Œ vs ê¸°ë…ì¼ ì•„ì˜ˆ ì•ˆ ì±™ê¸°ê¸°",
  "ì‹¸ìš°ë©´ ë°”ë¡œ í’€ê¸° vs í•˜ë£¨ ì§€ë‚˜ì„œ í’€ê¸°",
  "ì—¬í–‰ì€ ë‘˜ì´ë§Œ vs ì¹œêµ¬ ì»¤í”Œê¹Œì§€ ë„·ì´",

  "í•˜ë£¨ 1ë²ˆ ë¯¸ë˜ 10ì´ˆ ë³´ê¸° vs ê³¼ê±° 10ì´ˆ ë³´ê¸°",
  "ë§ˆìŒ ì½ê¸°(í™•ë¥  50%) vs ê±°ì§“ë§ ê°ì§€(í™•ë¥  90%)",
  "ìˆœê°„ì´ë™(1ì¼ 3íšŒ) vs ì‹œê°„ ë©ˆì¶¤(1ì¼ 10ì´ˆ)",
  "íˆ¬ëª…ì¸ê°„ vs ë™ë¬¼ê³¼ ëŒ€í™”",
  "ì´ˆëŠ¥ë ¥ ìˆëŠ”ë° ë‚¨ì´ ëª¨ë¦„ vs ì´ˆëŠ¥ë ¥ ì—†ëŠ”ë° ëª¨ë‘ ë¯¿ìŒ",
  "ì›í•˜ëŠ” ê¿ˆ ê¾¸ê¸° vs ê¿ˆ ì—†ì´ ê¹Šê²Œ ìê¸°",
  "í‰ìƒ ìš´ì´ ì¢‹ìŒ(ì‹¤ë ¥ 0) vs ì‹¤ë ¥ ì¢‹ìŒ(ìš´ 0)",
  "ë§¤ì¼ 1ë§Œì› ëœë¤ íšë“ vs ì£¼ 1íšŒ 10ë§Œì› í™•ì • íšë“",
  "ë§í•˜ë©´ í˜„ì‹¤ì´ ë¨(í•˜ë£¨ 1ë¬¸ì¥) vs ìƒê°í•˜ë©´ í˜„ì‹¤ì´ ë¨(í•˜ë£¨ 1ìƒê°)",
  "ì–´ë””ì„œë“  ê¸¸ ì•ˆ ìƒìŒ vs ëˆ„êµ¬ì™€ë„ ê¸ˆë°© ì¹œí•´ì§",
  "í•˜ë£¨ 30ë¶„ ê³µì¤‘ë¶€ì–‘ vs í•˜ë£¨ 30ë¶„ ì´ˆê³ ì† ë‹¬ë¦¬ê¸°",
  "ì†ëŒ€ë©´ ê³ ì¥ ê³ ì¹˜ê¸° vs ì†ëŒ€ë©´ ê¹¨ë—í•´ì§€ê¸°",
  "ë‚´ê°€ í•œ ì„ íƒ í•­ìƒ ì •ë‹µ vs ë‚´ê°€ í”¼í•œ ì„ íƒì´ ì •ë‹µ",
  "ì›í•˜ëŠ” ì‚¬ëŒê³¼ 10ë¶„ ëŒ€í™” vs ì›í•˜ëŠ” ì¥ì†Œì— 10ë¶„ ì²´ë¥˜",
  "í‰ìƒ ë‹¤ì´ì–´íŠ¸ í•„ìš” ì—†ìŒ vs í‰ìƒ ê°ê¸° ì•ˆ ê±¸ë¦¼",
  "ë‚˜ë§Œ ìë§‰ ë³´ì„ vs ë‚˜ë§Œ ë°°ê²½ìŒì•… ë“¤ë¦¼",
  "ê¸°ì–µë ¥ 2ë°° vs ì§‘ì¤‘ë ¥ 2ë°°",
  "ê°ì • ì»¨íŠ¸ë¡¤ ê°€ëŠ¥ vs í†µì¦ ì»¨íŠ¸ë¡¤ ê°€ëŠ¥",
  "ë§ë°œ Sê¸‰ vs ê¸€ë°œ Sê¸‰",
  "ì•„ì¹¨í˜• ì²œì¬ vs ë°¤í˜• ì²œì¬",

  "í‰ìƒ ì—¬ë¦„ë§Œ vs í‰ìƒ ê²¨ìš¸ë§Œ",
  "ì—¬í–‰ì€ ë°”ë‹¤ë§Œ vs ì‚°ë§Œ",
  "êµ­ë‚´ì—¬í–‰ë§Œ vs í•´ì™¸ì—¬í–‰ë§Œ(1ë…„ì— 1ë²ˆ)",
  "í˜¼ì ì—¬í–‰ë§Œ vs ë¬´ì¡°ê±´ ë‹¨ì²´ì—¬í–‰",
  "ë¹„í–‰ê¸°ë§Œ ê°€ëŠ¥ vs ê¸°ì°¨ë§Œ ê°€ëŠ¥",
  "ìˆ™ì†ŒëŠ” í˜¸í…”ë§Œ vs ê²ŒìŠ¤íŠ¸í•˜ìš°ìŠ¤ë§Œ",
  "ê³„íš 100% ì„¸ìš°ê¸° vs ê³„íš 0% ì¦‰í¥",
  "ì‚¬ì§„ 1,000ì¥ ì°ê¸° vs ì‚¬ì§„ 0ì¥",
  "ê´€ê´‘ì§€ í•„ìˆ˜ vs ë§›ì§‘ í•„ìˆ˜",
  "ì§§ê²Œ ìì£¼ ì—¬í–‰ vs ê¸¸ê²Œ ê°€ë” ì—¬í–‰",
  "ìº í•‘ë§Œ ê°€ëŠ¥ vs ê¸€ë¨í•‘ë§Œ ê°€ëŠ¥",
  "ì—¬í–‰ ì¤‘ ì‡¼í•‘ ê¸ˆì§€ vs ì—¬í–‰ ì¤‘ ì¹´í˜ ê¸ˆì§€",
  "ì—¬í–‰ ì¤‘ ê¸¸ ìƒê¸° vs ì—¬í–‰ ì¤‘ ë¹„ ë§ê¸°",
  "ì—¬í–‰ ì¤‘ ë°°íƒˆ vs ì—¬í–‰ ì¤‘ íœ´ëŒ€í° ê³ ì¥",
  "ì—¬í–‰ì€ íë§ vs ì—¬í–‰ì€ ì•¡í‹°ë¹„í‹°",
  "ìƒˆë²½ ì¶œë°œ vs ë°¤ ë„ì°©",
  "ìœ ëª…í•œ ê³³ë§Œ vs ì•„ë¬´ë„ ëª¨ë¥´ëŠ” ê³³ë§Œ",
  "ì—¬í–‰ ë‚´ë‚´ í˜¼ì ì‹ì‚¬ vs ì—¬í–‰ ë‚´ë‚´ ë‹¨ì²´ ì‹ì‚¬",
  "ì§ ê°€ë³ê²Œ(ë¶ˆí¸) vs ì§ ë¬´ê²ê²Œ(í¸í•¨)",
  "ì—¬í–‰ ê²½ë¹„ 2ë°°(ë™í–‰ ë¶ˆê°€) vs ì—¬í–‰ ê²½ë¹„ ë°˜(ë™í–‰ ê°€ëŠ¥)",

  "ê²Œì„ì€ ìŠ¤í† ë¦¬í˜• vs ê²½ìŸí˜•",
  "ë¡¤/ì˜¤ë²„ì›Œì¹˜ ê°™ì€ íŒ€ê²Œì„ë§Œ vs ì‹±ê¸€ê²Œì„ë§Œ",
  "í•˜ë£¨ 1ì‹œê°„ë§Œ ê²Œì„ vs ì£¼ë§ì— ëª°ì•„ ê²Œì„",
  "ê²Œì„í•  ë•Œ ìŒì„±ì±„íŒ… í•„ìˆ˜ vs ì±„íŒ… ê¸ˆì§€",
  "ìŠ¹ë¶€ìš• ê°•í•œ íŒŒí‹° vs ì›ƒê¸´ íŒŒí‹°",
  "ë­í¬ë§Œ vs ì¼ë°˜ë§Œ",
  "í‚¤ë³´ë“œ ì†Œë¦¬ í° ê¸°ê³„ì‹ vs ì¡°ìš©í•œ ë©¤ë¸Œë ˆì¸",
  "ì½˜ì†”ë§Œ vs PCë§Œ",
  "ëª¨ë°”ì¼ê²Œì„ë§Œ vs ë³´ë“œê²Œì„ë§Œ",
  "ê²Œì„í•  ë•Œ ê°„ì‹ ê¸ˆì§€ vs ìŒë£Œ ê¸ˆì§€",
  "ì˜í™”ëŠ” ê·¹ì¥ë§Œ vs ì§‘ì—ì„œë§Œ",
  "ë“œë¼ë§ˆ ì •ì£¼í–‰ë§Œ vs ë§¤ì£¼ ë³¸ë°©ë§Œ",
  "ìŠ¤í¬ ë‹¹í•˜ê¸° vs ê²°ë§ ë¯¸ë£¨ê¸°",
  "ì±… ì¢…ì´ì±…ë§Œ vs ì „ìì±…ë§Œ",
  "ìŒì•…ì€ ë¼ì´ë¸Œë§Œ vs ìŒì›ë§Œ",
  "ë…¸ë˜ëŠ” í›„ë ´ë§Œ ë°˜ë³µ vs 1ì ˆë§Œ ë°˜ë³µ",
  "ì¶¤ì¶”ê¸° ì˜í•¨ vs ë…¸ë˜ ì˜í•¨",
  "ê·¸ë¦¼ ì˜ ê·¸ë¦¼ vs ì‚¬ì§„ ì˜ ì°ìŒ",
  "ì·¨ë¯¸ 10ê°œ ì–•ê²Œ vs ì·¨ë¯¸ 1ê°œ ê¹Šê²Œ",
  "í˜¼ì ì·¨ë¯¸ vs ê°™ì´ ì·¨ë¯¸",

  "ë‚´ í° ìë™ìˆ˜ì • í•­ìƒ ì´ìƒí•¨ vs ìë™ì™„ì„± í•­ìƒ ìŠ¤í¬í•¨",
  "ì¸í„°ë„· ì†ë„ 2ë°° vs ë°°í„°ë¦¬ 2ë°°",
  "SNS ì™„ì „ ëŠê¸° vs ìœ íŠœë¸Œ ì™„ì „ ëŠê¸°",
  "ê´‘ê³  ì—†ëŠ” ëŒ€ì‹  ì›” 1ë§Œì› vs ë¬´ë£Œ ëŒ€ì‹  ê´‘ê³  2ë°°",
  "ë‹¤í¬ëª¨ë“œë§Œ ê°€ëŠ¥ vs ë¼ì´íŠ¸ëª¨ë“œë§Œ ê°€ëŠ¥",
  "í‚¤ë³´ë“œ ì´ëª¨ì§€ ê¸ˆì§€ vs ì§¤ ì €ì¥ ê¸ˆì§€",
  "ê²€ìƒ‰ì€ í•­ìƒ 1í˜ì´ì§€ì— ì •ë‹µ vs ê²€ìƒ‰ì€ í•­ìƒ ëœë¤(ëŒ€ì‹  ì‹ ê¸°í•¨)",
  "ì§€ë„ì•± ì—†ê¸° vs ë²ˆì—­ì•± ì—†ê¸°",
  "í° ë¶„ì‹¤ í•œ ë‹¬ 1ë²ˆ vs ì¸í„°ë„· ëŠê¹€ í•œ ë‹¬ 1ë²ˆ",
  "ì‚¬ì§„ ìë™ë°±ì—… ì—†ìŒ vs ì—°ë½ì²˜ ìë™ë°±ì—… ì—†ìŒ",
  "AIê°€ ë‚´ ì¼ì • ë‹¤ ê´€ë¦¬ vs AIê°€ ë‚´ ëŒ€í™” ë‹¤ ìš”ì•½(í”„ë¼ì´ë²„ì‹œ ê±±ì •)",
  "ì˜ìƒí†µí™”ë§Œ ê°€ëŠ¥ vs ìŒì„±í†µí™”ë§Œ ê°€ëŠ¥",
  "ë¬¸ìë§Œ ê°€ëŠ¥ vs ì „í™”ë§Œ ê°€ëŠ¥",
  "ëª¨ë“  ì•Œë¦¼ ì¼œì§ ê°•ì œ vs ëª¨ë“  ì•Œë¦¼ êº¼ì§ ê°•ì œ",
  "ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ì–¼êµ´ì¸ì‹ë§Œ vs OTPë§Œ",
  "í° ì¹´ë©”ë¼ í™”ì§ˆ ìµœê°• vs ìŠ¤í”¼ì»¤ ìŒì§ˆ ìµœê°•",
  "í° ì¼œëŠ”ë° 30ì´ˆ vs ì•± ì—´ë¦¬ëŠ”ë° 10ì´ˆ",
  "í° í™”ë©´ ì‘ê²Œë§Œ vs í¬ê²Œë§Œ",
  "ì¸í„°ë„· ëŒ“ê¸€ ì ˆëŒ€ ëª» ë‹¬ê¸° vs ì¢‹ì•„ìš” ì ˆëŒ€ ëª» ëˆ„ë¥´ê¸°",
  "ë‚´ ê³¼ê±° ê²€ìƒ‰ê¸°ë¡ ê³µê°œ vs ë‚´ ë¯¸ë˜ ê²€ìƒ‰ê¸°ë¡ ê³µê°œ",

  "í‰ìƒ ëª¨ìë§Œ ì“°ê¸° vs í‰ìƒ ì„ ê¸€ë¼ìŠ¤ë§Œ ì“°ê¸°",
  "ë§¤ì¼ ê°™ì€ ì˜· vs ë§¤ì¼ ëœë¤ ì˜·(ë‚´ê°€ ê³ ë¥¸ ì  ì—†ìŒ)",
  "íŒ¨ë”©ë§Œ ì…ê¸° vs ì½”íŠ¸ë§Œ ì…ê¸°",
  "ìš´ë™ì€ ìœ ì‚°ì†Œë§Œ vs ê·¼ë ¥ë§Œ",
  "í•˜ë£¨ 1ë§Œ ë³´ ê±·ê¸° ê°•ì œ vs í•˜ë£¨ 30ë¶„ ìŠ¤íŠ¸ë ˆì¹­ ê°•ì œ",
  "ì‚´ ì•ˆ ì°œ(ëŒ€ì‹  ì²´ë ¥ ì•½í•¨) vs ì²´ë ¥ ìµœê°•(ëŒ€ì‹  ì‚´ ì˜ ì°œ)",
  "í‚¤ 5cm ë” vs ì‹œë ¥ 1.0 í‰ìƒ ìœ ì§€",
  "í”¼ë¶€ ì™„ë²½ vs ë¨¸ë¦¬ìˆ± ì™„ë²½",
  "ëª©ì†Œë¦¬ ì¢‹ì•„ì§ vs ì†ê¸€ì”¨ ì¢‹ì•„ì§",
  "ê¸°ì–µë ¥ì€ ë‚˜ì¨(ìŠ¤íŠ¸ë ˆìŠ¤ ì—†ìŒ) vs ê¸°ì–µë ¥ì€ ì¢‹ìŒ(ê³¼ê±° í‘ì—­ì‚¬ ì„ ëª…)",
  "ì›ƒìŒì†Œë¦¬ í¬ê²Œ ë“¤ë¦¼ vs í•œìˆ¨ì†Œë¦¬ í¬ê²Œ ë“¤ë¦¼",
  "ë§í•˜ë©´ í•­ìƒ ë¼ì„ì´ ë§ìŒ vs ë§í•˜ë©´ í•­ìƒ ë°˜ë§ë¡œ ë“¤ë¦¼",
  "í•˜ë£¨ 10ë²ˆ â€œí—‰â€ ìë™ ë°˜ì‘ vs í•˜ë£¨ 10ë²ˆ â€œã…‹ã…‹â€ ìë™ ë°˜ì‘",
  "ì›ƒê¸´ ë“œë¦½ ìë™ ìƒì„±(ê°€ë” ì°ë ) vs ë¶„ìœ„ê¸° íŒŒì•… ìë™(ê°€ë” ê³¼ëª°ì…)",
  "í•­ìƒ ì¢‹ì€ í–¥ê¸° vs í•­ìƒ ì¢‹ì€ ì´‰ê°(ì˜·/ì¹¨êµ¬)",
  "ë‚ ì”¨ì— ë¯¼ê°(ê¸°ë¶„ ì¢Œìš°) vs ìŒì‹ì— ë¯¼ê°(ê¸°ë¶„ ì¢Œìš°)",
  "ê¸¸ê±°ë¦¬ì—ì„œ ì•„ëŠ” ì‚¬ëŒ ìì£¼ ë§Œë‚¨ vs íƒë°° ë§¤ì¼ ì˜´(í•„ìš” ì—†ëŠ” ê²ƒë„)",
  "ì§€ê°‘ í•­ìƒ ë‘êº¼ì›€(ì˜ìˆ˜ì¦) vs ê°€ë°© í•­ìƒ ë¬´ê±°ì›€(ì¡ë™ì‚¬ë‹ˆ)",
  "ë‚´ ë°© í•­ìƒ ì •ë¦¬ë¨(ëŒ€ì‹  ë¬¼ê±´ ìœ„ì¹˜ ëœë¤) vs ë‚´ ë°© í•­ìƒ ì–´ì§ˆëŸ¬ì§(ëŒ€ì‹  ìœ„ì¹˜ ê³ ì •)",
  "ë¬¼ê±´ ìì£¼ ìƒì–´ë²„ë¦¼ vs ë¬¼ê±´ ìì£¼ ê¹¨ëœ¨ë¦¼",

  "í‰ìƒ â€œì˜ˆìŠ¤â€ë§Œ ë§í•˜ê¸° vs í‰ìƒ â€œë…¸â€ë§Œ ë§í•˜ê¸°",
  "ë‚˜ë§Œ ëª¨ë‘ì˜ ë§ì´ 0.8ë°°ì† vs ë‚˜ë§Œ ëª¨ë‘ì˜ ë§ì´ 1.5ë°°ì†",
  "ì›ƒìŒ ì°¸ê¸° ì±Œë¦°ì§€ ë§¤ì¼ 1ë²ˆ vs ëˆˆë¬¼ ì°¸ê¸° ì±Œë¦°ì§€ ë§¤ì¼ 1ë²ˆ",
  "ëª¨ë“  ë†ë‹´ì— ì§„ì§€í•˜ê²Œ ë‹µí•¨ vs ëª¨ë“  ì§ˆë¬¸ì— ë†ë‹´ìœ¼ë¡œ ë‹µí•¨",
  "ì†Œê°œíŒ… 10ë²ˆ ì—°ì† vs ë©´ì ‘ 10ë²ˆ ì—°ì†",
  "í•˜ë£¨ 1ë²ˆ ëœë¤ ì¹­ì°¬ ë°›ê¸° vs í•˜ë£¨ 1ë²ˆ ëœë¤ ì§€ì  ë°›ê¸°",
  "í•­ìƒ ì²«ì¸ìƒ Sê¸‰ vs í•­ìƒ ì˜¤ë˜ ë³´ë©´ Sê¸‰",
  "ì–´ìƒ‰í•¨ 0(ëŒ€ì‹  ëˆˆì¹˜ 0) vs ëˆˆì¹˜ 100(ëŒ€ì‹  ì–´ìƒ‰í•¨ 100)",
  "ë§ì‹¤ìˆ˜ ìì£¼ vs í–‰ë™ì‹¤ìˆ˜ ìì£¼",
  "ë‚˜ë§Œ ì‹œê°„ ê°ê° ì •í™• vs ë‚˜ë§Œ ë°©í–¥ ê°ê° ì •í™•",
  "1ë…„ì— ë”± í•œ ë²ˆ ëŒ€ë°• vs ë§¤ë‹¬ ì†Œí™•í–‰ ê¾¸ì¤€",
  "ì˜¤ëŠ˜ì˜ ìš´ì„¸ 100% ë§ìŒ vs ë‚´ì¼ì˜ ë‚ ì”¨ 100% ë§ìŒ",
  "ë‚´ ì¸ìƒ OSTê°€ ë“¤ë¦¼ vs ë‚´ ì¸ìƒ ìë§‰ì´ ë³´ì„",
  "ê°ì •ì´ ìƒ‰ìœ¼ë¡œ ë³´ì„ vs ê±°ì§“ë§ì´ ì†Œë¦¬ë¡œ ë“¤ë¦¼",
  "ë‚˜ë§Œ í•˜ë£¨ 25ì‹œê°„ vs ë‚˜ë§Œ í•˜ë£¨ 23ì‹œê°„",
  "ë‚´ ë§ì´ í•­ìƒ íšŒìë¨ vs ë‚´ í–‰ë™ì´ í•­ìƒ ë°ˆì´ ë¨",
  "í‰ìƒ â€œëŒ€ë°•â€ë§Œ ê°íƒ„ì‚¬ vs í‰ìƒ â€œí—â€ë§Œ ê°íƒ„ì‚¬",
  "í•˜ë£¨ 1ë²ˆ ëœë¤ ì†Œì›(ì‘ìŒ) vs 1ë…„ì— 1ë²ˆ í° ì†Œì›",
  "ë‚´ê°€ ì°ì€ ì‚¬ì§„ì€ í•­ìƒ ì˜ ë‚˜ì˜´ vs ë‚¨ì´ ì°ì–´ì¤€ ì‚¬ì§„ì€ í•­ìƒ ì˜ ë‚˜ì˜´",
  "ì§€ê¸ˆ ë‹¹ì¥ 10ì–µ(ëŒ€ì‹  ê¸°ì–µ 1ê°œ ì‚­ì œ) vs ë§¤ë‹¬ 300ë§Œ í‰ìƒ(ê¸°ì–µ ê·¸ëŒ€ë¡œ)"
];

// ---- ì¹´í…Œê³ ë¦¬(êµ¬ê°„ íƒœê¹…)
const CATEGORIES = [
  { key: "food",   nameKo: "ğŸœ ìŒì‹",       nameEn: "ğŸœ Food",       start: 1,   end: 20  },
  { key: "life",   nameKo: "ğŸ  ìƒí™œ",       nameEn: "ğŸ  Life",       start: 21,  end: 40  },
  { key: "work",   nameKo: "ğŸ’¼ ì§ì¥/í•™êµ",  nameEn: "ğŸ’¼ Work/School", start: 41,  end: 60  },
  { key: "love",   nameKo: "ğŸ’¬ ì¹œêµ¬/ì—°ì• ",  nameEn: "ğŸ’¬ Friends/Love", start: 61,  end: 80  },
  { key: "fantasy",nameKo: "âœ¨ ì´ˆëŠ¥ë ¥",     nameEn: "âœ¨ Superpower", start: 81,  end: 100 },
  { key: "travel", nameKo: "ğŸ§³ ì—¬í–‰",       nameEn: "ğŸ§³ Travel",       start: 101, end: 120 },
  { key: "hobby",  nameKo: "ğŸ® ì·¨ë¯¸/ì½˜í…ì¸ ", nameEn: "ğŸ® Hobby/Content", start: 121, end: 140 },
  { key: "tech",   nameKo: "ğŸ“± í…Œí¬/SNS",   nameEn: "ğŸ“± Tech/SNS",   start: 141, end: 160 },
  { key: "style",  nameKo: "ğŸ’ª ë¼ì´í”„/ìš´ë™", nameEn: "ğŸ’ª Life/Exercise", start: 161, end: 180 },
  { key: "misc",   nameKo: "ğŸŒ€ ê¸°íƒ€",       nameEn: "ğŸŒ€ Misc",       start: 181, end: 200 },
];

const $ = (sel) => document.querySelector(sel);
const gameEl = $("#game");
const pillMode = $("#pillMode");
const pillCat = $("#pillCat");
const pillProgress = $("#pillProgress");
const progressFill = $("#progressFill");
const hintText = $("#hintText");
const txtOut = $("#txtOut");
const msg = $("#msg");
const selCategory = $("#selCategory");

function setMsg(text, isWarn=false) {
  msg.textContent = text;
  msg.className = "small" + (isWarn ? " warn" : "");
}

// --- RNG: seedable (ì˜¤ëŠ˜ì˜ 10ë¬¸ì œìš©)
function xorshift32(seed) {
  let x = seed >>> 0;
  return function() {
    x ^= x << 13; x >>>= 0;
    x ^= x >> 17; x >>>= 0;
    x ^= x << 5;  x >>>= 0;
    return (x >>> 0) / 4294967296;
  };
}
function randInt(rng, min, max) {
  return Math.floor(rng() * (max - min + 1)) + min;
}
function pickUniqueIndices(poolIndices, count, rng=Math.random) {
  const arr = poolIndices.slice();
  // Fisher-Yates shuffle (partial)
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor((typeof rng === "function" ? rng() : Math.random()) * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr.slice(0, Math.min(count, arr.length));
}

function splitVs(q) {
  const parts = q.split(" vs ");
  if (parts.length < 2) return { a: q.trim(), b: "" };
  return { a: parts[0].trim(), b: parts.slice(1).join(" vs ").trim() };
}

function categoryOfIndex1(i1) { // 1-based index
  return CATEGORIES.find(c => i1 >= c.start && i1 <= c.end) || null;
}

// --- ìƒíƒœ
let current = null;
// current = { indices1: number[10] (1-based), mode: string, categoryKey?: string, id: string }
const LS_KEY_PREFIX = "ff_balance_answers_";

function makeGameId(indices1, mode, categoryKey="") {
  // ì§§ê²Œ ê³ ìœ  + ì¬í˜„ ê°€ëŠ¥
  const base = indices1.join("-");
  let h = 2166136261;
  for (let i = 0; i < base.length; i++) {
    h ^= base.charCodeAt(i);
    h = Math.imul(h, 16777619);
  }
  const time = Date.now().toString(36).slice(-4);
  return (h >>> 0).toString(36) + "_" + mode + "_" + (categoryKey || "all") + "_" + time;
}

function encodeIndices(indices1) {
  // 1-based indices -> base36, '.' join
  return indices1.map(n => n.toString(36)).join(".");
}
function decodeIndices(s) {
  if (!s) return null;
  const parts = s.split(".").filter(Boolean);
  const nums = parts.map(p => parseInt(p, 36)).filter(n => Number.isFinite(n) && n >= 1 && n <= QUESTIONS.length);
  // ì¤‘ë³µ ì œê±° ìœ ì§€(ìˆœì„œ ìœ ì§€)
  const seen = new Set();
  const uniq = [];
  for (const n of nums) {
    if (!seen.has(n)) { seen.add(n); uniq.push(n); }
  }
  return uniq.length ? uniq : null;
}

function setHashFromCurrent() {
  if (!current) return;
  const params = new URLSearchParams();
  params.set("g", encodeIndices(current.indices1));
  params.set("m", current.mode);
  if (current.categoryKey) params.set("c", current.categoryKey);
  location.hash = params.toString();
}

function readHashGame() {
  const raw = (location.hash || "").replace(/^#/, "");
  if (!raw) return null;
  const params = new URLSearchParams(raw);
  const g = params.get("g");
  const indices1 = decodeIndices(g);
  if (!indices1 || indices1.length < 2) return null;
  const mode = params.get("m") || "link";
  const categoryKey = params.get("c") || "";
  // ê¸¸ì´ 10ì´ ì•„ë‹ˆë©´ 10ìœ¼ë¡œ ë§ì¶”ê¸°(ë¶€ì¡±í•˜ë©´ ëœë¤ ë³´ì¶©)
  let final = indices1.slice(0, 10);
  if (final.length < 10) {
    const pool = [...Array(QUESTIONS.length)].map((_, i) => i + 1).filter(n => !final.includes(n));
    const add = pickUniqueIndices(pool, 10 - final.length);
    final = final.concat(add);
  }
  return { indices1: final, mode, categoryKey };
}

function getKSTDateKey() {
  // Asia/Seoul ê¸°ì¤€ YYYY-MM-DD
  const fmt = new Intl.DateTimeFormat("en-CA", { timeZone: "Asia/Seoul", year: "numeric", month: "2-digit", day: "2-digit" });
  return fmt.format(new Date()); // ex) 2026-01-02
}
function seedFromString(str) {
  // ê°„ë‹¨ í•´ì‹œ seed
  let h = 0;
  for (let i = 0; i < str.length; i++) {
    h = (h * 31 + str.charCodeAt(i)) >>> 0;
  }
  return h >>> 0;
}

function loadAnswers(gameId) {
  try {
    const raw = localStorage.getItem(LS_KEY_PREFIX + gameId);
    if (!raw) return {};
    const obj = JSON.parse(raw);
    return (obj && typeof obj === "object") ? obj : {};
  } catch { return {}; }
}
function saveAnswers(gameId, answers) {
  try { localStorage.setItem(LS_KEY_PREFIX + gameId, JSON.stringify(answers)); } catch {}
}

function computeProgress(answers) {
  const answered = Object.keys(answers).length;
  return { answered, total: 10 };
}

function updateMeta(answers) {
  const p = computeProgress(answers);
  pillMode.textContent = t("pillMode", { mode: current ? current.mode : "-" });
  let catName;
  if (current?.categoryKey) {
    const cat = CATEGORIES.find(c => c.key === current.categoryKey);
    catName = cat ? (currentLang === "en" ? cat.nameEn : cat.nameKo) : current.categoryKey;
  } else {
    catName = currentLang === "en" ? "All" : "ì „ì²´";
  }
  pillCat.textContent = t("pillCat", { cat: catName });
  pillProgress.textContent = t("pillProgress", { answered: p.answered, total: p.total });
  progressFill.style.width = `${(p.answered / p.total) * 100}%`;

  if (!current) {
    hintText.textContent = t("hintText");
  } else if (p.answered < p.total) {
    hintText.textContent = t("hintTextInProgress");
  } else {
    hintText.textContent = t("hintTextComplete");
  }
}

function buildShareText(answers) {
  const lines = [];
  const kst = getKSTDateKey();
  const link = location.href;
  lines.push(t("shareTextTitle", { kst }));
  lines.push(`${t("shareTextLink")} ${link}`);
  lines.push("");

  current.indices1.forEach((idx1, i) => {
    const q = QUESTIONS[idx1 - 1];
    const { a, b } = splitVs(q);
    const picked = answers[i] === "A" ? a : (answers[i] === "B" ? b : t("shareTextNotSelected"));
    lines.push(`${i+1}. ${a}  vs  ${b}`);
    lines.push(`   ğŸ‘‰ ${t("shareTextMyChoice")} ${picked}`);
  });

  lines.push("");
  lines.push(t("shareTextPrompt"));
  return lines.join("\n");
}

function renderGame() {
  if (!current) return;

  const answers = loadAnswers(current.id);
  gameEl.innerHTML = "";

  current.indices1.forEach((idx1, i) => {
    const q = QUESTIONS[idx1 - 1];
    const cat = categoryOfIndex1(idx1);
    const { a, b } = splitVs(q);

    const card = document.createElement("div");
    card.className = "card";

    const top = document.createElement("div");
    top.className = "qtop";

    const left = document.createElement("div");
    left.innerHTML = `<span class="qnum">Q${i+1}</span> <span class="small">${t("questionNumber", { num: idx1 })}</span>`;
    const right = document.createElement("div");
    right.className = "qcat";
    right.textContent = cat ? (currentLang === "en" ? cat.nameEn : cat.nameKo) : t("categoryNone");
    top.append(left, right);

    const title = document.createElement("p");
    title.className = "qtitle";
    title.textContent = q;

    const choices = document.createElement("div");
    choices.className = "choices";

    const btnA = document.createElement("button");
    btnA.className = "choiceBtn";
    btnA.innerHTML = `<strong>A</strong>${a}`;

    const btnB = document.createElement("button");
    btnB.className = "choiceBtn";
    btnB.innerHTML = `<strong>B</strong>${b}`;

    const selected = answers[i] || null;
    if (selected === "A") btnA.classList.add("selected");
    if (selected === "B") btnB.classList.add("selected");
    if (selected) { btnA.disabled = true; btnB.disabled = true; }

    btnA.addEventListener("click", () => {
      answers[i] = "A";
      saveAnswers(current.id, answers);
      renderGame();
    });
    btnB.addEventListener("click", () => {
      answers[i] = "B";
      saveAnswers(current.id, answers);
      renderGame();
    });

    choices.append(btnA, btnB);

    const status = document.createElement("div");
    status.className = "status";
    const s = answers[i] ? (answers[i] === "A" ? t("statusSelectedA") : t("statusSelectedB")) : t("statusNotSelected");
    status.textContent = s;

    card.append(top, title, choices, status);
    gameEl.appendChild(card);
  });

  updateMeta(answers);
  txtOut.value = buildShareText(answers);
  setMsg("");
}

// --- ê²Œì„ ìƒì„±
function startGame(indices1, mode, categoryKey="") {
  current = {
    indices1,
    mode,
    categoryKey,
    id: makeGameId(indices1, mode, categoryKey)
  };
  setHashFromCurrent();
  // ë§í¬ë¡œ ê³µìœ í–ˆì„ ë•Œë„ ê²°ê³¼(ë‚´ ì„ íƒ)ëŠ” ë¸Œë¼ìš°ì € ë¡œì»¬ì—ë§Œ ì €ì¥ë˜ê²Œ ì˜ë„
  renderGame();
}

function makePoolAll() {
  return [...Array(QUESTIONS.length)].map((_, i) => i + 1);
}
function makePoolCategory(key) {
  const cat = CATEGORIES.find(c => c.key === key);
  if (!cat) return makePoolAll();
  const pool = [];
  for (let i = cat.start; i <= cat.end; i++) pool.push(i);
  return pool;
}

function genRandomAll() {
  const pool = makePoolAll();
  const indices1 = pickUniqueIndices(pool, 10);
  startGame(indices1, "random", "");
}

function genCategorySelectedOrRandom() {
  // ì„ íƒí•œ ì¹´í…Œê³ ë¦¬ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ìš°ì„ , ì•„ë‹ˆë©´ ëœë¤ ì¹´í…Œê³ ë¦¬
  const selected = selCategory.value;
  const catKey = selected || CATEGORIES[Math.floor(Math.random() * CATEGORIES.length)].key;

  let pool = makePoolCategory(catKey);
  let indices1 = pickUniqueIndices(pool, 10);

  // ì¹´í…Œê³ ë¦¬ í’€ í¬ê¸°ê°€ 10 ë¯¸ë§Œì´ë©´(í˜„ì¬ëŠ” ëª¨ë‘ 20ì´ë¼ ê´œì°®ìŒ) ë¶€ì¡±ë¶„ì€ ì „ì²´ì—ì„œ ì±„ì›€
  if (indices1.length < 10) {
    const restPool = makePoolAll().filter(n => !indices1.includes(n));
    indices1 = indices1.concat(pickUniqueIndices(restPool, 10 - indices1.length));
  }
  startGame(indices1, "category", catKey);
}

function genToday10() {
  const dateKey = getKSTDateKey(); // KST ê¸°ì¤€
  const seed = seedFromString("ff_today_" + dateKey);
  const rng = xorshift32(seed);
  const pool = makePoolAll();
  const indices1 = pickUniqueIndices(pool, 10, rng);
  startGame(indices1, "today", "");
}

// --- ë§í¬ ë³µì‚¬
async function copyCurrentLink() {
  if (!current) { setMsg(t("msgGenerateFirst"), true); return; }
  try {
    await navigator.clipboard.writeText(location.href);
    setMsg(t("msgLinkCopied"));
  } catch {
    // fallback
    const tmp = document.createElement("textarea");
    tmp.value = location.href;
    document.body.appendChild(tmp);
    tmp.select();
    document.execCommand("copy");
    tmp.remove();
    setMsg(t("msgLinkCopied"));
  }
}

// --- TXT ë‚´ë³´ë‚´ê¸°
function exportTxt() {
  if (!current) { setMsg(t("msgGenerateFirst"), true); return; }
  const answers = loadAnswers(current.id);
  const text = buildShareText(answers);
  const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  const kst = getKSTDateKey();
  a.href = url;
  a.download = `funnyfunny_balance_${kst}.txt`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
  setMsg(t("msgTxtSaved"));
}

// --- ë‚´ ê²°ê³¼ ê³µìœ 
async function shareResultText() {
  if (!current) { setMsg(t("msgGenerateFirst"), true); return; }
  const answers = loadAnswers(current.id);
  const text = buildShareText(answers);
  try {
    if (navigator.share) {
      await navigator.share({ title: t("shareResultTitle"), text, url: location.href });
      setMsg(t("msgShareComplete"));
      return;
    }
  } catch {
    // fall through to clipboard
  }
  try {
    await navigator.clipboard.writeText(text);
    setMsg(t("msgResultCopied"));
  } catch {
    setMsg(t("msgShareNotSupported"), true);
  }
}

// --- ì´ˆê¸°í™”
function resetAll() {
  current = null;
  location.hash = "";
  gameEl.innerHTML = "";
  txtOut.value = "";
  updateMeta({});
  setMsg(t("msgResetComplete"));
}

// --- ì´ˆê¸° ë¡œë”©: ì¹´í…Œê³ ë¦¬ ì…€ë ‰íŠ¸ ì±„ìš°ê¸°
function initCategorySelect() {
  CATEGORIES.forEach(c => {
    const opt = document.createElement("option");
    opt.value = c.key;
    opt.textContent = currentLang === "en" ? c.nameEn : c.nameKo;
    selCategory.appendChild(opt);
  });
}

// --- í•´ì‹œë¡œ ì§„ì…í•œ ê²½ìš° ë¡œë“œ
function bootFromHashOrIdle() {
  const h = readHashGame();
  if (!h) {
    updateMeta({});
    return;
  }
  const indices1 = h.indices1;
  const mode = h.mode || "link";
  const categoryKey = h.categoryKey || "";
  current = {
    indices1,
    mode,
    categoryKey,
    id: makeGameId(indices1, mode, categoryKey)
  };
  // í•´ì‹œë¡œ ë“¤ì–´ì˜¤ë©´ ê·¸ëŒ€ë¡œ ë Œë”
  renderGame();
  setMsg(t("msgGameLoaded"));
}

$("#btnRandom").addEventListener("click", genRandomAll);
$("#btnCatRandom").addEventListener("click", genCategorySelectedOrRandom);
$("#btnToday").addEventListener("click", genToday10);
$("#btnCopyLink").addEventListener("click", copyCurrentLink);
$("#btnExportTxt").addEventListener("click", exportTxt);
$("#btnShareResult").addEventListener("click", shareResultText);
$("#btnReset").addEventListener("click", resetAll);

// í•´ì‹œ ë³€ê²½ ì‹œì—ë„ ë¡œë“œ(ê³µìœ  ë§í¬ ì—´ê¸° ë“±)
window.addEventListener("hashchange", () => {
  // ì´ë¯¸ ê²Œì„ ì¤‘ì´ë©´ ê·¸ëŒ€ë¡œ ë‘ê³ , í•´ì‹œê°€ ì™¸ë¶€ì—ì„œ ë°”ë€ ê²½ìš°ë§Œ ë°˜ì˜
  const h = readHashGame();
  if (!h) return;
  const indicesKey = encodeIndices(h.indices1);
  if (current && encodeIndices(current.indices1) === indicesKey) return;

  current = {
    indices1: h.indices1,
    mode: h.mode || "link",
    categoryKey: h.categoryKey || "",
    id: makeGameId(h.indices1, h.mode || "link", h.categoryKey || "")
  };
  renderGame();
});

document.querySelectorAll(".lang-switch button").forEach((button) => {
  button.addEventListener("click", () => {
    setLang(button.dataset.lang, { updateUrl: true });
  });
});

setLang(detectLang(), { updateUrl: false });
initCategorySelect();
bootFromHashOrIdle();
</script>

<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="5145068706"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

</body>
</html>
